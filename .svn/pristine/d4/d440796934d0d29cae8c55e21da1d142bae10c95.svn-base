<?php

class SearchAction extends Action{
    public function search(){
        
        $this->list=M("goods")->where("id is not null ".$and)->order("update_time desc")->limit(3)->select();
        $this->display();       
    }
    
    public function searchcontent(){
        $this ->key = $_GET['key'];
        $this->display();
        
    }
    
    public function searchcontentselect(){
        
        $conter = $_GET['counter'];
        $conter = $conter*20;
        if($_GET['key']){
            $and .= " and Title like '%".$_GET['key']."%'";
        }
       
        if($_GET['filter'] == 1){
            $order = "Sales_num desc";
        }else if($_GET['filter'] == 2){
            $order = "Price asc";
        }else if($_GET['filter'] == 3){
            $order = "Quan_price desc";
        }else{
            $order = "update_time desc";
        }
        
        $data = M("goods")->where("id is not null ".$and)->order($order)->limit($conter,20)->select();
        //$data['sql'] = M()->getLastSql();
        echo json_encode($data);
        
    }
   
}

?>