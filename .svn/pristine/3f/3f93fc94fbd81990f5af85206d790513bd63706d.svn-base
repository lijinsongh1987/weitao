<?php

class PageAction extends Action{
    public function page(){
        $this -> types = $_GET['types'];
        $this->typelist=M("goodstype")->select();
        $this->display();       
    }
   
    public function goodslist(){
        
        if($_POST['types'] == 1){
            //优惠券类目
        }
        if($_POST['types'] == 2){
            $and .=" and Price <= 9.9";
            //9.9类目
        }
        if($_POST['types'] == 3){
            //今日特惠类目
        }
        if($_POST['filter'] == 1){
            $order = "Sales_num desc";
        }else if($_POST['filter'] == 2){
            $order = "Price asc";
        }else if($_POST['filter'] == 3){
            $order = "Quan_price desc";
        }else{
            $order = "update_time desc";
        }
        if($_POST['id'] != 0){
            $and .=" and Cid = '".$_POST['id']."'";
        }else{
            $and .=" and Cid != 0";
        }
        $data = M("goods")->where("id is not null ".$and)->order($order)->limit(20)->select();
        echo json_encode($data);
        
    }
}

?>